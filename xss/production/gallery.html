


<!DOCTYPE html>

<html>

<head>

<title></title>

<script type="text/javascript" src="js/jquery-1.4.2.min.js" ></script>
<script type="text/javascript" src="js/jquery.utils.js"></script>
<script type="text/javascript" src="js/utils.js"></script>
<script type="text/javascript" src="js/prototype.js"></script>

<script type="text/javascript" src="js/ms/ms-ui.js"></script>
<script type="text/javascript" src="js/ms/ms-streamer.js"></script>
<script type="text/javascript" src="js/ms/ms-state.js"></script>

<script type="text/javascript">			
var g_ui;
var g_elapsed = -1;
var g_delta = 0.0;
var g_canvas;



            frame_anim = Class.create(ms.state.Sequence,
{
    initialize: function($super)
    {
        $super();

                            var this__ = this;
            this.parent_sequence = null;
            var ____i1 = new ms.state.Interpolator(
                "x1", 
                default_interpolate,
                function(value)
                {
                    this__.left.set_x1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x1", new ms.state.State(0, 2, ____i1));                    
                    
            var ____i2 = new ms.state.Interpolator(
                "y1", 
                default_interpolate,
                function(value)
                {
                    this__.left.set_y1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y1", new ms.state.State(0, 2, ____i2));                    
                    
            var ____i3 = new ms.state.Interpolator(
                "x2", 
                default_interpolate,
                function(value)
                {
                    this__.left.set_x2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x2", new ms.state.State(0, 2, ____i3));                    
                    
            var ____i4 = new ms.state.Interpolator(
                "y2", 
                default_interpolate,
                function(value)
                {
                    this__.left.set_y2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y2", new ms.state.State(0, 2, ____i4));                    
                    
            var ____i5 = new ms.state.Interpolator(
                "x1", 
                default_interpolate,
                function(value)
                {
                    this__.right.set_x1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x1", new ms.state.State(0, 2, ____i5));                    
                    
            var ____i6 = new ms.state.Interpolator(
                "y1", 
                default_interpolate,
                function(value)
                {
                    this__.right.set_y1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y1", new ms.state.State(0, 2, ____i6));                    
                    
            var ____i7 = new ms.state.Interpolator(
                "x2", 
                default_interpolate,
                function(value)
                {
                    this__.right.set_x2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x2", new ms.state.State(0, 2, ____i7));                    
                    
            var ____i8 = new ms.state.Interpolator(
                "y2", 
                default_interpolate,
                function(value)
                {
                    this__.right.set_y2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y2", new ms.state.State(0, 2, ____i8));                    
                    
            var ____i9 = new ms.state.Interpolator(
                "x1", 
                default_interpolate,
                function(value)
                {
                    this__.top.set_x1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x1", new ms.state.State(0, 2, ____i9));                    
                    
            var ____i10 = new ms.state.Interpolator(
                "y1", 
                default_interpolate,
                function(value)
                {
                    this__.top.set_y1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y1", new ms.state.State(0, 2, ____i10));                    
                    
            var ____i11 = new ms.state.Interpolator(
                "x2", 
                default_interpolate,
                function(value)
                {
                    this__.top.set_x2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x2", new ms.state.State(0, 2, ____i11));                    
                    
            var ____i12 = new ms.state.Interpolator(
                "y2", 
                default_interpolate,
                function(value)
                {
                    this__.top.set_y2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y2", new ms.state.State(0, 2, ____i12));                    
                    
            var ____i13 = new ms.state.Interpolator(
                "x1", 
                default_interpolate,
                function(value)
                {
                    this__.bottom.set_x1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x1", new ms.state.State(0, 2, ____i13));                    
                    
            var ____i14 = new ms.state.Interpolator(
                "y1", 
                default_interpolate,
                function(value)
                {
                    this__.bottom.set_y1(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y1", new ms.state.State(0, 2, ____i14));                    
                    
            var ____i15 = new ms.state.Interpolator(
                "x2", 
                default_interpolate,
                function(value)
                {
                    this__.bottom.set_x2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "x2", new ms.state.State(0, 2, ____i15));                    
                    
            var ____i16 = new ms.state.Interpolator(
                "y2", 
                default_interpolate,
                function(value)
                {
                    this__.bottom.set_y2(value);
                },
                [
                    {t: 0, value: null},
                    {t: 2, value: null},
                ]);
            this.addAction(null, "y2", new ms.state.State(0, 2, ____i16));                    
                    
            this.on_start = function()
            {
                ____i1.keys[0].value = this__.left.x1;
                ____i1.keys[1].value = this__.dest.x;
                ____i2.keys[0].value = this__.left.y1;
                ____i2.keys[1].value = this__.dest.y;
                ____i3.keys[0].value = this__.left.x2;
                ____i3.keys[1].value = this__.dest.x + this__.dest.w;
                ____i4.keys[0].value = this__.left.y2;
                ____i4.keys[1].value = this__.dest.y;
                ____i5.keys[0].value = this__.right.x1;
                ____i5.keys[1].value = this__.dest.x + this__.dest.w;
                ____i6.keys[0].value = this__.right.y1;
                ____i6.keys[1].value = this__.dest.y;
                ____i7.keys[0].value = this__.right.x2;
                ____i7.keys[1].value = this__.dest.x + this__.dest.w;
                ____i8.keys[0].value = this__.right.y2;
                ____i8.keys[1].value = this__.dest.y + this__.dest.h;
                ____i9.keys[0].value = this__.top.x1;
                ____i9.keys[1].value = this__.dest.x + this__.dest.w;
                ____i10.keys[0].value = this__.top.y1;
                ____i10.keys[1].value = this__.dest.y + this__.dest.h;
                ____i11.keys[0].value = this__.top.x2;
                ____i11.keys[1].value = this__.dest.x;
                ____i12.keys[0].value = this__.top.y2;
                ____i12.keys[1].value = this__.dest.y + this__.dest.h;
                ____i13.keys[0].value = this__.bottom.x1;
                ____i13.keys[1].value = this__.dest.x;
                ____i14.keys[0].value = this__.bottom.y1;
                ____i14.keys[1].value = this__.dest.y + this__.dest.h;
                ____i15.keys[0].value = this__.bottom.x2;
                ____i15.keys[1].value = this__.dest.x;
                ____i16.keys[0].value = this__.bottom.y2;
                ____i16.keys[1].value = this__.dest.y;
            }

                },

    target : null,
    target_set : function (value)
    {
        this.target = value;
        this.left = value[0];
        this.right = value[1];
        this.top = value[2];
        this.bottom = value[3];
    },
});

        
            fade_in = Class.create(ms.state.Sequence,
{
    initialize: function($super)
    {
        $super();

                            var this__ = this;
            this.parent_sequence = null;
            var ____i17 = new ms.state.Interpolator(
                "alpha", 
                default_interpolate,
                function(value)
                {
                    this__.target.alpha(value);
                },
                [
                    {t: 0, value: 0},
                    {t: 1, value: 0.300000012},
                ]);
            this.addAction(null, "alpha", new ms.state.State(0, 1, ____i17));                    
                    
            var ____i18 = new ms.state.Interpolator(
                "alpha", 
                default_interpolate,
                function(value)
                {
                    this__.target.alpha(value);
                },
                [
                    {t: 1, value: 0.300000012},
                    {t: 2, value: 1},
                ]);
            this.addAction(null, "alpha", new ms.state.State(1, 2, ____i18));                    
                    

                },

});

        
function default_interpolate(a, b, t)
{
    return a + (b - a)*t;
}

function start(resolution)  
{  
	var start = new Date().getTime();  
	function update()  
	{  
		var now   = new Date().getTime();
        if (g_elapsed < 0)
            g_delta = 0; //first update
        else
		    g_delta  = now - g_elapsed;  
		
        g_elapsed = now; 
              
		var context = g_canvas.getContext('2d');
		g_ui.update(g_delta, context);
        
        update_sequences(g_delta);
              
		window.setTimeout(update, resolution);  
	}  
	window.setTimeout(update, resolution);  
}  

var g_sequences = [];

                    var page1;
                
                    var page2;
                
                    var page3;
                        var load_package;
        var img1;
        var img2;
        var img3;
        var ln1;
        var ln2;
        var ln3;
        var ln4;
        var ln5;
        var ln6;
        var ln7;
        var ln8;
        var ln9;
        var ln10;
        var ln11;
        var ln12;
        var anim1;
        var anim2;
        var anim3;
        var fade1;
        var fade2;
        var fade3;
        var label1;
        var loading_bar;
        var next;
        var prev;


function update_sequences(delta)
{
	for(var i = 0; i < g_sequences.length; i++)
	{
		var seq = g_sequences[i]
		if (seq.running)
        {
            seq.update(delta);
        }
	}
}

window.onload = function() 
{
	var drawingCanvas = document.getElementById("myCanvas");
        
	g_canvas = drawingCanvas;
	if (drawingCanvas && drawingCanvas.getContext)
	{
		var client =
		{
			width: 1000,
			height: 640,
			canvas: drawingCanvas
		};
            
		var streamer = new ms.streamer.Streamer();
		var ui = new ms.ui.Manager(client, streamer);
		var resources = new ms.streamer.PackageContainer();
		g_ui = ui;


                    var ui_images = 
                    [
                            'images/arrow.png',
            'images/arrow2.png',
            'images/progress.empty.png',
            'images/progress.full.png',

                    ];
                
                    var ____p1 = 
                    [
                
                        {src: "images/n739882607_704246_8746.jpg"},
                    
                        {src: "images/n739882607_704109_46.jpg"},
                    
                        {src: "images/n739882607_704119_5840.jpg"},
                    
                    ];
                    
                    page1 = new ms.streamer.Package(streamer, ____p1);
                    resources.register("page1", page1);            
                
                    var ____p2 = 
                    [
                
                        {src: "images/n739882607_794182_2354.jpg"},
                    
                        {src: "images/n739882607_704116_4921.jpg"},
                    
                        {src: "images/n739882607_704120_6153.jpg"},
                    
                    ];
                    
                    page2 = new ms.streamer.Package(streamer, ____p2);
                    resources.register("page2", page2);            
                
                    var ____p3 = 
                    [
                
                        {src: "images/n739882607_704118_5476.jpg"},
                    
                        {src: "images/n739882607_704247_9725.jpg"},
                    
                        {src: "images/n739882607_704117_5209.jpg"},
                    
                    ];
                    
                    page3 = new ms.streamer.Package(streamer, ____p3);
                    resources.register("page3", page3);            
                
		ui.load_images(ui_images, function()
		{
			drawingCanvas.onmousemove = function(ev)
			{
				ui.mouse_move(ev.clientX, ev.clientY);                  
			};

			drawingCanvas.onmousedown = function(ev)
			{
				ui.mouse_down(ev.clientX, ev.clientY);                  
			};

			drawingCanvas.onmouseup = function(ev)
			{
				ui.mouse_up(ev.clientX, ev.clientY);                  
			};


			var application = ui.root;
                                    img1 = application.newImage('null');
    img1.rect(0, 0, 100, 100);
                    

                                            img2 = application.newImage('null');
    img2.rect(120, 140, 200, 200);
                    

                                            img3 = application.newImage('null');
    img3.rect(300, 300, 200, 200);
                    

                            ln1 = application.newLine();
            ln1.set_x1(20);
            ln1.set_x2(40);
            ln1.set_y1(40);
            ln1.set_y2(140);
            ln1.set_lineWidth(1);
        
                    ln2 = application.newLine();
            ln2.set_x1(20);
            ln2.set_x2(20);
            ln2.set_y1(40);
            ln2.set_y2(140);
            ln2.set_lineWidth(1);
        
                    ln3 = application.newLine();
            ln3.set_x1(20);
            ln3.set_x2(20);
            ln3.set_y1(40);
            ln3.set_y2(140);
            ln3.set_lineWidth(1);
        
                    ln4 = application.newLine();
            ln4.set_x1(20);
            ln4.set_x2(20);
            ln4.set_y1(40);
            ln4.set_y2(140);
            ln4.set_lineWidth(1);
        
                    ln5 = application.newLine();
            ln5.set_x1(20);
            ln5.set_x2(20);
            ln5.set_y1(40);
            ln5.set_y2(140);
            ln5.set_lineWidth(1);
        
                    ln6 = application.newLine();
            ln6.set_x1(20);
            ln6.set_x2(20);
            ln6.set_y1(40);
            ln6.set_y2(140);
            ln6.set_lineWidth(1);
        
                    ln7 = application.newLine();
            ln7.set_x1(20);
            ln7.set_x2(20);
            ln7.set_y1(40);
            ln7.set_y2(140);
            ln7.set_lineWidth(1);
        
                    ln8 = application.newLine();
            ln8.set_x1(20);
            ln8.set_x2(20);
            ln8.set_y1(40);
            ln8.set_y2(140);
            ln8.set_lineWidth(1);
        
                    ln9 = application.newLine();
            ln9.set_x1(20);
            ln9.set_x2(20);
            ln9.set_y1(40);
            ln9.set_y2(140);
            ln9.set_lineWidth(1);
        
                    ln10 = application.newLine();
            ln10.set_x1(20);
            ln10.set_x2(20);
            ln10.set_y1(40);
            ln10.set_y2(140);
            ln10.set_lineWidth(1);
        
                    ln11 = application.newLine();
            ln11.set_x1(20);
            ln11.set_x2(20);
            ln11.set_y1(40);
            ln11.set_y2(140);
            ln11.set_lineWidth(1);
        
                    ln12 = application.newLine();
            ln12.set_x1(20);
            ln12.set_x2(20);
            ln12.set_y1(40);
            ln12.set_y2(140);
            ln12.set_lineWidth(1);
        
                                    label1 = application.newLabel('bold 12px Verdana');
    label1.position(420, 10);
                    
            label1.text("Paintings by Dany Dennis");
        
                                    loading_bar = application.newProgressBar();
    loading_bar.rect(430, 610, 100, 4);
                    

                                            next = application.newButton('images/arrow2.png','images/arrow.png');
    next.rect(300, 580, 60, 60);
                    
            next.click = function()
            {    
                application.next_click();
            };
        
                                    prev = application.newButton('images/arrow.png','images/arrow2.png');
    prev.rect(600, 580, 60, 60);
                    
            prev.click = function()
            {    
                application.prev_click();
            };
        
                    load_package = new ms.state.Sequence();
                    g_sequences.push(load_package);
                                load_package.parent_sequence = null;
        load_package.target =  null;
    	load_package.percentage = function() 
    	{
    		if (!this.target)
    		{
    		    return;
    		}
    		var progress = this.target.progress();
    		if (progress >= 1)
    		{
    		    this.stop();
    		    loading_bar.setVisible(false);
    		    application.apply_images(this.target);
    		}
    		else
    		{
    		    loading_bar.percent = progress * 100;
    		}
    	};
        var ____h1 = new ms.state.Every(0.300000012, function(t)
        {
                    load_package.percentage();
                
        });
        load_package.addAction(null, null, new ms.state.State(0, 0, ____h1));                    
                
                    anim1 = new frame_anim();
                    g_sequences.push(anim1);
                                anim1.parent_sequence = null;
        anim1.target = null;
        anim1.target_set = function (value)
        {
            anim1.target = value;
            this.left = value[0];
            this.right = value[1];
            this.top = value[2];
            this.bottom = value[3];
        }
                
                    anim2 = new frame_anim();
                    g_sequences.push(anim2);
                                anim2.parent_sequence = null;
        anim2.target = null;
        anim2.target_set = function (value)
        {
            anim2.target = value;
            this.left = value[0];
            this.right = value[1];
            this.top = value[2];
            this.bottom = value[3];
        }
                
                    anim3 = new frame_anim();
                    g_sequences.push(anim3);
                                anim3.parent_sequence = null;
        anim3.target = null;
        anim3.target_set = function (value)
        {
            anim3.target = value;
            this.left = value[0];
            this.right = value[1];
            this.top = value[2];
            this.bottom = value[3];
        }
                
                    fade1 = new fade_in();
                    g_sequences.push(fade1);
                                fade1.parent_sequence = null;
                
                    fade2 = new fade_in();
                    g_sequences.push(fade2);
                                fade2.parent_sequence = null;
                
                    fade3 = new fade_in();
                    g_sequences.push(fade3);
                                fade3.parent_sequence = null;
                

                            var ____a1 = 
                            [
                        
                                {
        
        			package : "page1",
        		
        			image_location : [
        		
                        {
        
        			h : 247,
        		
        			w : 350,
        		
        			x : 300,
        		
        			y : 200,
        		}
        ,
                    
                        {
        
        			h : 516,
        		
        			w : 200,
        		
        			x : 700,
        		
        			y : 50,
        		}
        ,
                    
                        {
        
        			h : 337,
        		
        			w : 250,
        		
        			x : 0,
        		
        			y : 0,
        		}
        ,
                    
        			],
        		}
        ,
                            
                                {
        
        			package : "page2",
        		
        			image_location : [
        		
                        {
        
        			h : 274,
        		
        			w : 600,
        		
        			x : 200,
        		
        			y : 300,
        		}
        ,
                    
                        {
        
        			h : 273,
        		
        			w : 280,
        		
        			x : 20,
        		
        			y : 20,
        		}
        ,
                    
                        {
        
        			h : 200,
        		
        			w : 200,
        		
        			x : 600,
        		
        			y : 40,
        		}
        ,
                    
        			],
        		}
        ,
                            
                                {
        
        			package : "page3",
        		
        			image_location : [
        		
                        {
        
        			h : 221,
        		
        			w : 300,
        		
        			x : 700,
        		
        			y : 0,
        		}
        ,
                    
                        {
        
        			h : 346,
        		
        			w : 400,
        		
        			x : 300,
        		
        			y : 50,
        		}
        ,
                    
                        {
        
        			h : 300,
        		
        			w : 300,
        		
        			x : 0,
        		
        			y : 200,
        		}
        ,
                    
        			],
        		}
        ,
                            
                            ];
                            application.pages =  ____a1;
            application.page_count =  3;
            application.page_index =  0;
            application.animations =  [anim1, anim2, anim3];
            application.fades =  [fade1, fade2, fade3];
        	application.apply_images = function(package) 
        	{
        		var pos = application.pages[application.page_index].image_location;
        		var images = [img1, img2, img3];
        		var curr = 0;
        		var i_iterable = images;
        		for(var i_iterator = 0; i_iterator < i_iterable.length; i_iterator++)
        		{
        		  var i = i_iterable[i_iterator];
        		    i.image(package.items[curr].resource);
        		    i.rect(pos[curr].x, pos[curr].y, pos[curr].w, pos[curr].h);
        		    curr++;
        		}
        	};
        	application.do_transition = function() 
        	{
        		var cnt = 0;
        		var page = application.pages[application.page_index];
        		var anim_iterable = application.animations;
        		for(var anim_iterator = 0; anim_iterator < anim_iterable.length; anim_iterator++)
        		{
        		  var anim = anim_iterable[anim_iterator];
        		    anim.dest = page.image_location[cnt];
        		    var seed = Math.floor(Math.random() * 4);
        		    var target = [];
        		    for(var i = 0; i < 4; i++)
        		    {
        		        var idx = seed + i;
        		        if (idx > 3)
        		        {
        		            idx -= 4;
        		        }
        		        target.push(anim.target[idx]);
        		    }
        		    anim.target_set(target);
        		    anim.start();
        		    application.fades[cnt].start();
        		    cnt++;
        		}
        		if (page.package)
        		{
        		    var package = resources.get(page.package);
        		    load_package.target = package;
        		    if (!package.loaded)
        		    {
        		        load_package.start();
        		        loading_bar.setVisible(true);
        		        if (!package.loading)
        		        {
        		            package.load();
        		        }
        		    }
        		    else
        		    {
        		        loading_bar.setVisible(false);
        		        load_package.start();
        		    }
        		}
        	};
        	application.next_click = function() 
        	{
        		if (application.page_index < application.pages.length - 1)
        		{
        		    application.page_index++;
        		}
        		else
        		{
        		    application.page_index = 0;
        		}
        		application.do_transition();
        	};
        	application.prev_click = function() 
        	{
        		if (application.page_index > 0)
        		{
        		    application.page_index--;
        		}
        		else
        		{
        		    application.page_index = application.page_count - 1;
        		}
        		application.do_transition();
        	};
            application.init = function()
            {    
                anim1.target_set([ln1, ln2, ln3, ln4]);
                anim2.target_set([ln5, ln6, ln7, ln8]);
                anim3.target_set([ln9, ln10, ln11, ln12]);
                fade1.target = img1;
                fade2.target = img2;
                fade3.target = img3;
                application.do_transition();
            };
        

                    if (application.init)
                    {
                        application.init();
                    }
                    
			start();
			ui.draw(drawingCanvas.getContext('2d'));
		});
	}
}
</script>

</head>

<body>

	<canvas id="myCanvas" width="1000" height="640">

		<p>Your browser doesn't support canvas.</p>

	</canvas>

</body>

</html>
